<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Resume Match Analysis</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
* { box-sizing:border-box; font-family:'Inter',sans-serif; }

body {
    margin:0;
    min-height:100vh;
    background:linear-gradient(135deg,#0f172a,#1e293b);
    display:flex;
    justify-content:center;
    padding:30px;
}

.container {
    width:100%;
    max-width:960px;
    background:white;
    border-radius:18px;
    padding:40px;
    box-shadow:0 30px 70px rgba(0,0,0,.3);
}

h1 { margin:0; font-size:30px; color:#0f172a; }
.subtitle { color:#64748b; font-size:14px; margin-bottom:24px; }

.pill {
    display:inline-block;
    padding:6px 14px;
    font-size:13px;
    border-radius:999px;
    font-weight:600;
    background:#e0e7ff;
    color:#3730a3;
    margin-bottom:16px;
}

/* SCORE */
.score-box {
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:30px;
    background:#f1f5f9;
    border-radius:16px;
    padding:26px;
    margin-bottom:34px;
}

.score { font-size:52px; font-weight:700; color:#4f46e5; }

.progress {
    height:12px;
    background:#e5e7eb;
    border-radius:999px;
    overflow:hidden;
    margin-top:12px;
}
.progress-bar {
    height:100%;
    width:{{ score }}%;
    background:linear-gradient(90deg,#6366f1,#4f46e5);
}

/* GRID */
.grid {
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:26px;
}

.card, .section {
    background:#f8fafc;
    border-radius:16px;
    padding:26px;
    border:1px solid #e5e7eb;
}

.section h3, .card h3 {
    margin:0 0 14px;
    font-size:18px;
    color:#0f172a;
}

.tag-list { display:flex; flex-wrap:wrap; gap:10px; }
.tag {
    background:#e0e7ff;
    color:#3730a3;
    padding:7px 14px;
    font-size:13px;
    border-radius:999px;
    font-weight:500;
}
.tag.missing { background:#fee2e2; color:#991b1b; }

.metric-row {
    display:flex;
    justify-content:space-between;
    font-size:14px;
    margin-bottom:6px;
}

.metric-bar {
    height:8px;
    background:#e5e7eb;
    border-radius:999px;
    overflow:hidden;
    margin-bottom:12px;
}
.metric-fill {
    height:100%;
    background:linear-gradient(90deg,#6366f1,#4f46e5);
}

.footer {
    margin-top:36px;
    display:flex;
    justify-content:center;
    gap:14px;
}
.footer a {
    padding:12px 26px;
    background:linear-gradient(135deg,#6366f1,#4f46e5);
    color:white;
    text-decoration:none;
    border-radius:12px;
    font-weight:600;
}

@media(max-width:768px){
    .grid, .score-box { grid-template-columns:1fr; }
}

/* WARNINGS */
.warning-box {
    padding:14px 18px;
    border-radius:12px;
    font-size:14px;
    margin-bottom:12px;
    display:flex;
    gap:10px;
    align-items:center;
}

.warning-critical {
    background:#fee2e2;
    color:#991b1b;
    border-left:6px solid #dc2626;
}
.warning-moderate {
    background:#ffedd5;
    color:#9a3412;
    border-left:6px solid #f97316;
}
.warning-warning {
    background:#fef9c3;
    color:#854d0e;
    border-left:6px solid #eab308;
}
.warning-success {
    background:#dcfce7;
    color:#166534;
    border-left:6px solid #16a34a;
}
</style>
</head>

<body>
<div class="container">

<h1>Resume Match Analysis</h1>
<div class="subtitle">
ATS-aligned comparison of resume and job description
</div>

<div class="pill">Overall Match Confidence: {{ confidence_level }}</div>

<!-- OVERALL SCORE -->
<div class="score-box">
    <div>
        <div class="score">{{ score }}%</div>
        <div class="progress"><div class="progress-bar"></div></div>
        <div class="pill">
            {% if score >= 75 %}Strong Match
            {% elif score >= 50 %}Partial Match
            {% else %}Low Match{% endif %}
        </div>
    </div>

    <div style="font-size:14px;color:#334155;">
        <p><strong>Score Interpretation</strong></p>
        <p>
            Skills Matched: <strong>{{ skills|length }}</strong><br>
            Skills Missing: <strong>{{ missing_skills|length }}</strong>
        </p>
    </div>
</div>

<!-- SCORE BREAKDOWN -->
<div class="section">
<h3>üìà Skill Match Breakdown</h3>
<div class="metric-row"><span>Total Job Skills</span><strong>{{ score_breakdown.total_jd_skills }}</strong></div>
<div class="metric-row"><span>Matched Skills</span><strong>{{ score_breakdown.matched_skills }}</strong></div>
<div class="metric-row"><span>Missing Skills</span><strong>{{ score_breakdown.missing_skills }}</strong></div>
</div>

<div class="grid">

<div class="card">
<h3>‚úÖ Detected Resume Skills</h3>
<div class="tag-list">
{% for skill in skills %}
<span class="tag">{{ skill }}</span>
{% empty %}
<span>No skills detected</span>
{% endfor %}
</div>
</div>

<div class="section">
<h3>üöÄ Improvement Opportunities</h3>
<ul style="font-size:14px;line-height:1.7;">
{% for skill in missing_skills|slice:":5" %}
<li>Add experience demonstrating <strong>{{ skill }}</strong></li>
{% empty %}
<li>No critical skill gaps identified üéâ</li>
{% endfor %}
</ul>
</div>

<div class="section">
<h3>üìä Resume Quality Indicators</h3>

<div class="metric-row"><span>Technical Skill Coverage</span><span>{{ section_scores.technical }}%</span></div>
<div class="metric-bar"><div class="metric-fill" style="width:{{ section_scores.technical }}%"></div></div>

<div class="metric-row"><span>Experience Relevance</span><span>{{ section_scores.experience }}%</span></div>
<div class="metric-bar"><div class="metric-fill" style="width:{{ section_scores.experience }}%"></div></div>

<div class="metric-row"><span>ATS Readability</span><span>{{ section_scores.ats }}%</span></div>
<div class="metric-bar"><div class="metric-fill" style="width:{{ section_scores.ats }}%"></div></div>
</div>

</div>

<div class="section">
    <h3>üìä ATS Resume Scorecard</h3>

    <div class="metric-row">
        <span>Keyword Match</span>
        <strong>{{ ats_scores.keyword_match }}%</strong>
    </div>

    <div class="metric-bar">
        <div class="metric-fill" style="width:{{ ats_scores.keyword_match }}%"></div>
    </div>

    <div class="metric-row">
        <span>Section Coverage</span>
        <strong>{{ ats_scores.section_coverage }}%</strong>
    </div>

    <div class="metric-bar">
        <div class="metric-fill" style="width:{{ ats_scores.section_coverage }}%"></div>
    </div>

    <div class="metric-row">
        <span>Skill Relevance</span>
        <strong>{{ ats_scores.skill_relevance }}%</strong>
    </div>

    <div class="metric-bar">
        <div class="metric-fill" style="width:{{ ats_scores.skill_relevance }}%"></div>
    </div>

    <div class="metric-row">
        <span>Readability</span>
        <strong>{{ ats_scores.readability }}%</strong>
    </div>

    <div class="metric-bar">
        <div class="metric-fill" style="width:{{ ats_scores.readability }}%"></div>
    </div>

    <hr style="margin:14px 0">

    <div class="metric-row">
        <span><strong>Overall ATS Compatibility</strong></span>
        <strong>{{ ats_scores.overall }}%</strong>
    </div>
</div>


<!-- ROLE MATCH -->
<div class="section">
<h3>üéØ Role & Requirement Alignment</h3>

<ul style="font-size:14px;line-height:1.6;">
<li><strong>Target Role:</strong> {{ jd_role }}</li>
<li><strong>Resume Role:</strong> {{ resume_role }}</li>
<li><strong>Expected Level:</strong> {{ jd_level }}</li>
<li><strong>Resume Level:</strong> {{ resume_level }}</li>
</ul>

<p><strong>Role Fit Score:</strong> {{ role_fit_score }}%</p>
<p><strong>Requirement Coverage:</strong> {{ requirement_match_score }}%</p>

<div class="section">
    <h3>üßë‚Äçüíº Recruiter Feedback</h3>

    <div class="rewrite-box">
        {% for line in recruiter_feedback.splitlines %}
        {% if "SECTION:" in line %}
            <h4>{{ line|cut:"SECTION:" }}</h4>
        {% elif line|length > 0 %}
            <p>{{ line }}</p>
        {% endif %}
    {% endfor %}
    </div>
</div>


<h4 style="margin-top:18px;">üö¶ Match Insights</h4>
{% for w in warnings %}
<div class="warning-box warning-{{ w.level }}">
<strong>
{% if w.level == "critical" %}üî¥ Critical
{% elif w.level == "moderate" %}üü† Moderate
{% elif w.level == "warning" %}üü° Warning
{% else %}üü¢ Good Fit{% endif %}
</strong>
<span>{{ w.message }}</span>
</div>
{% endfor %}

<h4 style="margin-top:18px;">üìå Key Job Requirements</h4>
<ul style="font-size:13px;color:#475569;line-height:1.6;">
{% for r in requirements|slice:":6" %}
<li>{{ r }}</li>
{% empty %}
<li>No explicit requirements detected</li>
{% endfor %}
</ul>
</div>

<div class="card">
<h3>‚ö†Ô∏è Missing or Recommended Skills</h3>
<div class="tag-list">
{% for skill in missing_skills %}
<span class="tag missing">{{ skill }}</span>
{% empty %}
<span>No missing skills üéâ</span>
{% endfor %}
</div>
</div>

<div class="footer">
<a href="{% url 'upload_resume' %}">Analyze Another Resume</a>
<a href="{% url 'download_report' %}?format=pdf">Download PDF</a>
<a href="{% url 'download_report' %}?format=docx">Download DOCX</a>
</div>

</div>
</body>
</html>
